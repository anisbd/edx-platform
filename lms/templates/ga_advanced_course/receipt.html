<%inherit file="../main.html" />
<%namespace name='static' file='/static_content.html'/>

<%!
from django.core.urlresolvers import reverse
from django.utils.translation import ugettext as _
from courseware.courses import course_image_url, get_course_about_section, get_course_by_id
from shoppingcart.processors.GMO import create_order_id
from util.date_utils import strftime_localized
from ga_advanced_course.models import AdvancedCourseTypes
%>

<%block name="pagetitle">${_("Purchase Receipt")}</%block>

<%block name="bodyclass">ticket receipt</%block>

<div class="ticket_page_wrap">
  % if advanced_course.course_type == AdvancedCourseTypes.F2F:
  <h2>${_("Face 2 Face Classroom")} ${_("Purchase Receipt")}</h2>
  % endif
  <section class="section">
    % if show_thanks_msg:
    <p id="thanks-msg" class="catch middle">${_("Purchase completion")}</p>
    <div class="course_select_area clear">
      <p>${_("Purchase of the ticket has been completed. To the email address in your registration to {platform_name}, I was sent a receipt.").format(platform_name=platform_name)}</p>
    </div>
    % endif
    % if order.status == 'refunded':
    <div class="course_select_area clear">
      <p class="red">${_("This ticket has been cancelled.")}</p>
    </div>
    % endif
    <p class="catch middle">${_("Receipt")}</p>
    <div class="receipt_area">
      % if advanced_course.course_type == AdvancedCourseTypes.F2F:
      <h3>${_("{course_name} course").format(course_name=course_name) | h} ${_("Face 2 Face Classroom")}<br>${advanced_course.display_name | h}</h3>
      % endif
      <img class="img course_img" src="${course_image}" alt="">
      <div class="item_area clear">
        <%
            item, course = shoppingcart_items[0]
        %>
        <div class="items">
          <h4>${_("Buy the ticket")}</h4>
          <p id="ticket-name">${advanced_course_ticket.display_name | h}</p>
        </div>
        <div class="items">
          <h4>${_("Opening Time")}</h4>
          <p id="course-opening-time">${strftime_localized(advanced_course.start_date, '%Y/%m/%d (%a)')}<br>${strftime_localized(advanced_course.start_time, '%H:%M')} - ${strftime_localized(advanced_course.end_time, '%H:%M')}</p>
        </div>
        <div class="items">
          <h4>${_("Meeting Place")}</h4>
          <p id="course-place">${advanced_course.place_name | h}</p>
        </div>
        <div class="items">
          <h4>${_("Payment amount")}</h4>
          <p id="ticket-price">Â¥${'{:,d}'.format(advanced_course_ticket.price_with_tax)} (${_("Including tax")})</p>
        </div>
        <div class="items">
          <h4>${_("Payment method")}</h4>
          <p>
            <span id="payment-method">${item.payment_method | h}</span>
            % if item.order.bill_to_ccnum:
            <br>${item.order.bill_to_ccnum | h}
            % endif
          </p>
        </div>
        <div class="items">
          <h4>${_("Purchase Information")}</h4>
          <p>
            ${_("Receipt Number")} <span id="receipt-number">#${create_order_id(order)}</span><br>
            ${strftime_localized(order_purchase_datetime, '%Y/%m/%d %H:%M:%S')} ${_("Purchase")}
          </p>
        </div>
      </div>
      <a href="${reverse('advanced_course:courses_{}'.format(advanced_course.course_type), args=[course.id])}" class="t_btn big center clear">${_("View Details")}</a>
    </div>
    <a href="${reverse('dashboard')}" class="t_btn big mapege clear">${_("View Dashboard")}</a>
  </section>
</div>
